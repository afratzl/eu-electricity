<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EU Electricity Production - Real-time Renewable Electricity Tracking</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <span class="nav-title">
                <svg width="32" height="21" viewBox="0 0 810 540" style="vertical-align: middle; margin-right: 10px;">
                    <desc>European flag</desc>
                    <defs>
                        <g id="s">
                            <g id="c">
                                <path id="t" d="M0,0v1h0.5z" transform="translate(0,-1)rotate(18)"/>
                                <use href="#t" transform="scale(-1,1)"/>
                            </g>
                            <g id="a">
                                <use href="#c" transform="rotate(72)"/>
                                <use href="#c" transform="rotate(144)"/>
                            </g>
                            <use href="#a" transform="scale(-1,1)"/>
                        </g>
                    </defs>
                    <rect fill="#039" width="810" height="540"/>
                    <g fill="#fc0" transform="scale(30)translate(13.5,9)">
                        <use href="#s" y="-6"/>
                        <use href="#s" y="6"/>
                        <g id="l">
                            <use href="#s" x="-6"/>
                            <use href="#s" transform="rotate(150)translate(0,6)rotate(66)"/>
                            <use href="#s" transform="rotate(120)translate(0,6)rotate(24)"/>
                            <use href="#s" transform="rotate(60)translate(0,6)rotate(12)"/>
                            <use href="#s" transform="rotate(30)translate(0,6)rotate(42)"/>
                        </g>
                        <use href="#l" transform="scale(-1,1)"/>
                    </g>
                </svg>
                EU Electricity Production
            </span>
            <div class="nav-links">
                <a href="index.html" class="active">Home</a>
                <a href="live.html">Intraday</a>
                <a href="monthly.html">Monthly</a>
                <a href="trends.html">Trends</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <header class="hero-section-pro">
            <h1>European Union Electricity Production</h1>
            <p class="hero-subtitle-pro">Tracking Europe's electricity transition with real-time and historical data</p>
        </header>

        <div class="info-box-pro">
            <div class="info-item">
                <span class="info-label">Data Source</span>
                <span class="info-value">ENTSO-E Transparency Platform</span>
            </div>
            <div class="info-item">
                <span class="info-label">Last Updated</span>
                <span class="info-value" id="last-update-time">Loading...</span>
            </div>
        </div>

        <!-- Three main navigation cards -->
        <div class="cards-grid-pro">
            <div class="feature-card-pro">
                <div class="card-header">
                    <h2>Intraday</h2>
                    <span class="update-badge">Updates hourly</span>
                </div>
                <p class="card-description">Current wind, solar, and renewable production</p>
                <a href="live.html" class="card-button-pro">View Intraday Data →</a>
            </div>

            <div class="feature-card-pro">
                <div class="card-header">
                    <h2>Monthly Trends</h2>
                    <span class="update-badge">Updates daily</span>
                </div>
                <p class="card-description">10-year monthly comparisons for key sources</p>
                <a href="monthly.html" class="card-button-pro">Explore Trends →</a>
            </div>

            <div class="feature-card-pro">
                <div class="card-header">
                    <h2>Historical</h2>
                    <span class="update-badge">Updates daily</span>
                </div>
                <p class="card-description">Long-term trends and electricity transition data</p>
                <a href="trends.html" class="card-button-pro">View Historical →</a>
            </div>
        </div>

        <!-- Electricity Mix Summary Table -->
        <section class="summary-table-section-pro">
            <div class="section-header-pro">
                <h2>Electricity Mix Summary</h2>
                <p class="section-subtitle-pro">Production by source across different time periods</p>
            </div>
            
            <div class="table-controls-pro">
                <span class="control-label-pro">Display:</span>
                <div class="toggle-group">
                    <button id="toggle-percentage" class="toggle-btn-pro active" onclick="showPercentage()">
                        Percentage
                    </button>
                    <button id="toggle-absolute" class="toggle-btn-pro" onclick="showAbsolute()">
                        Absolute
                    </button>
                    <button id="toggle-change-2024" class="toggle-btn-pro" onclick="showChangePreviousYear()">
                        <span id="change-previous-year-label">Change from Previous Year</span>
                    </button>
                    <button id="toggle-change-2023" class="toggle-btn-pro" onclick="showChangeTwoYearsAgo()">
                        <span id="change-two-years-ago-label">Change from 2 Years Ago</span>
                    </button>
                    <button id="toggle-change" class="toggle-btn-pro" onclick="showChange()">
                        Change from 2015
                    </button>
                </div>
            </div>

            <div id="summary-table-container">
                <div class="loading-message-pro">Loading summary data...</div>
            </div>
        </section>

        <!-- About Section -->
        <section class="about-section-pro">
            <h2>About This Project</h2>
            <p>This site provides comprehensive tracking of European Union electricity generation data, monitoring the ongoing transition from fossil fuels to renewable sources.</p>
            
            <div class="features-grid-pro">
                <div class="feature-item-pro">
                    <strong>Real-time Data</strong>
                    <span>Hourly updates with 15-minute resolution</span>
                </div>
                <div class="feature-item-pro">
                    <strong>Historical Analysis</strong>
                    <span>10 years of monthly production data</span>
                </div>
                <div class="feature-item-pro">
                    <strong>27 EU Countries</strong>
                    <span>Aggregated data from all member states</span>
                </div>
                <div class="feature-item-pro">
                    <strong>12 Electricity Sources</strong>
                    <span>Solar, wind, hydro, gas, coal, nuclear, and more</span>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <p>Built with data from <a href="https://transparency.entsoe.eu/" target="_blank">ENTSO-E</a> | 
           Source code on <a href="https://github.com/afratzl/eu-energy-analysis" target="_blank">GitHub</a> | 
           Built by <a href="https://www.linkedin.com/in/alexfratzl/" target="_blank">Alex Fratzl</a> with Claude Sonnet</p>
    </footer>

    <script>
        // Dynamic year calculation
        const currentYear = new Date().getFullYear();
        const previousYear = currentYear - 1;
        const twoYearsAgo = currentYear - 2;
        
        // Load summary data (timestamp + table) - single fetch
        function loadSummaryData() {
            fetch('plots/energy_summary_table.json')
                .then(response => response.json())
                .then(data => {
                    // Update timestamp in info box
                    document.getElementById('last-update-time').textContent = data.last_updated;
                    // Display table
                    displaySummaryTable(data);
                })
                .catch(error => {
                    console.error('Error loading summary data:', error);
                    document.getElementById('last-update-time').textContent = 'unavailable';
                });
        }

        // Display summary table
        function displaySummaryTable(data) {
            let html = '<table class="summary-table-pro">';
            
            // Header
            html += \`
                <thead>
                    <tr>
                        <th>Source</th>
                        <th>Yesterday</th>
                        <th>Last Week</th>
                        <th>\${currentYear} YTD</th>
                        <th>\${previousYear}</th>
                    </tr>
                </thead>
                <tbody>
            \`;
            
            // Data rows
            data.sources.forEach(source => {
                const isAggregate = source.category.startsWith('aggregate');
                const isRenewable = source.category.includes('renewable');
                const rowClass = isAggregate ? 'row-aggregate-pro' : 'row-source-pro';
                const categoryClass = isRenewable ? 'renewable' : 'non-renewable';
                
                html += \`<tr class="\${rowClass} \${categoryClass}">\`;
                html += \`<td class="source-name-cell-pro">\${source.source}</td>\`;
                
                // Yesterday
                html += \`<td>
                    <span class="value-pct">\${source.yesterday.percentage}%</span>
                    <span class="value-abs" style="display:none">\${source.yesterday.twh} TWh</span>
                    <span class="value-change" style="display:none">\${source.yesterday.change_from_2015}</span>
                    <span class="value-change-2024" style="display:none">\${source.yesterday.change_from_2024}</span>
                    <span class="value-change-2023" style="display:none">\${source.yesterday.change_from_2023}</span>
                </td>\`;
                
                // Last Week
                html += \`<td>
                    <span class="value-pct">\${source.last_week.percentage}%</span>
                    <span class="value-abs" style="display:none">\${source.last_week.twh} TWh</span>
                    <span class="value-change" style="display:none">\${source.last_week.change_from_2015}</span>
                    <span class="value-change-2024" style="display:none">\${source.last_week.change_from_2024}</span>
                    <span class="value-change-2023" style="display:none">\${source.last_week.change_from_2023}</span>
                </td>\`;
                
                // YTD Current Year
                html += \`<td>
                    <span class="value-pct">\${source.ytd_2025.percentage}%</span>
                    <span class="value-abs" style="display:none">\${source.ytd_2025.twh.toFixed(2)} TWh</span>
                    <span class="value-change" style="display:none">\${source.ytd_2025.change_from_2015}</span>
                    <span class="value-change-2024" style="display:none">\${source.ytd_2025.change_from_2024}</span>
                    <span class="value-change-2023" style="display:none">\${source.ytd_2025.change_from_2023}</span>
                </td>\`;
                
                // Previous Year
                html += \`<td>
                    <span class="value-pct">\${source.year_2024.percentage}%</span>
                    <span class="value-abs" style="display:none">\${source.year_2024.twh.toFixed(2)} TWh</span>
                    <span class="value-change" style="display:none">\${source.year_2024.change_from_2015}</span>
                    <span class="value-change-2024" style="display:none">\${source.year_2024.change_from_2024}</span>
                    <span class="value-change-2023" style="display:none">\${source.year_2024.change_from_2023}</span>
                </td>\`;
                
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            html += \`<div class="table-footer-pro">Last updated: \${data.last_updated}</div>\`;
            
            document.getElementById('summary-table-container').innerHTML = html;
        }

        // Toggle functions
        function showPercentage() {
            document.querySelectorAll('.value-pct').forEach(el => el.style.display = 'inline');
            document.querySelectorAll('.value-abs').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2024').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2023').forEach(el => el.style.display = 'none');
            
            document.getElementById('toggle-percentage').classList.add('active');
            document.getElementById('toggle-absolute').classList.remove('active');
            document.getElementById('toggle-change').classList.remove('active');
            document.getElementById('toggle-change-2024').classList.remove('active');
            document.getElementById('toggle-change-2023').classList.remove('active');
        }

        function showAbsolute() {
            document.querySelectorAll('.value-pct').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-abs').forEach(el => el.style.display = 'inline');
            document.querySelectorAll('.value-change').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2024').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2023').forEach(el => el.style.display = 'none');
            
            document.getElementById('toggle-percentage').classList.remove('active');
            document.getElementById('toggle-absolute').classList.add('active');
            document.getElementById('toggle-change').classList.remove('active');
            document.getElementById('toggle-change-2024').classList.remove('active');
            document.getElementById('toggle-change-2023').classList.remove('active');
        }

        function showChange() {
            document.querySelectorAll('.value-pct').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-abs').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change').forEach(el => el.style.display = 'inline');
            document.querySelectorAll('.value-change-2024').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2023').forEach(el => el.style.display = 'none');
            
            document.getElementById('toggle-percentage').classList.remove('active');
            document.getElementById('toggle-absolute').classList.remove('active');
            document.getElementById('toggle-change').classList.add('active');
            document.getElementById('toggle-change-2024').classList.remove('active');
            document.getElementById('toggle-change-2023').classList.remove('active');
        }

        function showChangePreviousYear() {
            document.querySelectorAll('.value-pct').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-abs').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2024').forEach(el => el.style.display = 'inline');
            document.querySelectorAll('.value-change-2023').forEach(el => el.style.display = 'none');
            
            document.getElementById('toggle-percentage').classList.remove('active');
            document.getElementById('toggle-absolute').classList.remove('active');
            document.getElementById('toggle-change').classList.remove('active');
            document.getElementById('toggle-change-2024').classList.add('active');
            document.getElementById('toggle-change-2023').classList.remove('active');
        }

        function showChangeTwoYearsAgo() {
            document.querySelectorAll('.value-pct').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-abs').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2024').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.value-change-2023').forEach(el => el.style.display = 'inline');
            
            document.getElementById('toggle-percentage').classList.remove('active');
            document.getElementById('toggle-absolute').classList.remove('active');
            document.getElementById('toggle-change').classList.remove('active');
            document.getElementById('toggle-change-2024').classList.remove('active');
            document.getElementById('toggle-change-2023').classList.add('active');
        }

        // Load on page load
        window.addEventListener('DOMContentLoaded', () => {
            // Update toggle button labels with actual years
            document.getElementById('change-previous-year-label').textContent = \`Change from \${previousYear}\`;
            document.getElementById('change-two-years-ago-label').textContent = \`Change from \${twoYearsAgo}\`;
            
            loadSummaryData();
            
            // Always start with percentage view (no localStorage persistence)
            // This ensures button state and content are always in sync
        });
    </script>

    <style>
        /* I'll add the full styles section in a follow-up - this is getting very long */
    </style>

    <!-- GoatCounter Analytics -->
    <script data-goatcounter="https://eu-electricity.goatcounter.com/count"
            async src="//gc.zgo.at/count.js"></script>
</body>
</html>
